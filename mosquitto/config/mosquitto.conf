# mosquitto/config/mosquitto.conf

# =================================================================
# Default listener
# =================================================================
# Port to use for the default listener.
listener 1883 0.0.0.0

# Use the websockets protocol. Port 9001 is standard for MQTT over websockets.
listener 9001 0.0.0.0
protocol websockets

# =================================================================
# Persistence
# =================================================================
# Save database state on disk.
# MUST match the volume mount in docker-compose.yml
persistence true
persistence_location /mosquitto/data/

# =================================================================
# Logging
# =================================================================
# Log messages will be written to a file.
# MUST match the volume mount in docker-compose.yml
log_dest file /mosquitto/log/mosquitto.log

# Define which log types to record.
# Available types: debug, error, warning, notice, information, none, subscribe, unsubscribe, websockets, all.
log_type error
log_type warning
log_type notice
log_type information
# Uncomment below for more verbose logging if needed
# log_type all

# Log timestamp format
log_timestamp_format %Y-%m-%dT%H:%M:%S

# =================================================================
# Security - STARTING WITH ANONYMOUS ACCESS (For Development)
# =================================================================
# !! WARNING !!
# !! Allowing anonymous access is INSECURE for production environments. !!
# !! You SHOULD configure authentication (e.g., password file) for any real deployment. !!
allow_anonymous true

# --- IF YOU WANT PASSWORD AUTHENTICATION (Recommended for better security) ---
# 1. Comment out `allow_anonymous true` above.
# 2. Uncomment the following line:
# password_file /mosquitto/config/password.txt
# 3. Create the password file (see instructions below).

# --- IF YOU WANT ACCESS CONTROL LISTS (ACLs - More granular control) ---
# Requires authentication to be enabled first (e.g., password_file)
# 1. Ensure `allow_anonymous false` and `password_file` is set.
# 2. Uncomment the following line:
# acl_file /mosquitto/config/acl.conf
# 3. Create the acl.conf file defining permissions (see examples online).

# =================================================================
# Other Settings
# =================================================================
# Maximum number of queued messages per client.
# max_queued_messages 1000

# Set the maximum number of connections. -1 means limited by system resources.
# max_connections -1

# Message size limit in bytes. 0 means no limit (default). Be careful with large values.
# message_size_limit 0